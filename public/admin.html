<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Pine Nest Education Consult</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="font-sans bg-gray-50 text-gray-800" id="body">
    <nav class="bg-blue-900 text-white p-6 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <a href="/"><img src="placeholder.png" alt="Pine Nest Logo" class="h-20"></a>
            <button id="dark-mode-toggle" class="p-2 bg-gray-200 text-gray-800 rounded-full hover:bg-gray-300 transition duration-300">
                <i class="fas fa-moon"></i>
            </button>
        </nav>

    <section class="py-16">
        <div class="container mx-auto px-4">
            <h2 class="text-4xl font-bold text-blue-900 text-center mb-8 section-title">Admin Panel</h2>
            <div id="login-section" class="max-w-md mx-auto bg-white p-6 rounded-lg shadow-lg">
                <form id="login-form" class="max-w-md mx-auto">
                    <div class="mb-4">
                        <label class="block text-gray-700">Username</label>
                        <input type="text" id="username" placeholder="Username" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700">Password</label>
                        <input type="password" id="password" placeholder="Password" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button type="submit" class="w-full bg-blue-900 text-white p-3 rounded-lg hover:bg-blue-700 transition duration-300"><i class="fas fa-sign-in-alt"></i> Login</button>
                </form>
            </div>
            <div id="blog-form" class="blog-form max-w-md mx-auto bg-white p-6 rounded-lg shadow-lg mt-6 hidden">
                <h3 class="text-2xl font-bold text-blue-900 mb-4">Add Blog Post</h3>
                <div class="mb-4">
                    <label class="block text-gray-700">Title</label>
                    <input type="text" id="post-title" placeholder="Title" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700">Content</label>
                    <textarea id="post-content" placeholder="Content" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" rows="4"></textarea>
                </div>
                <button id="submit-post" class="w-full bg-blue-900 text-white p-3 rounded-lg hover:bg-blue-700 transition duration-300"><i class="fas fa-plus"></i> Submit</button>
            </div>
        </div>
    </section>

    <footer class="bg-blue-900 text-white py-6 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-4">Â© 2025 Pine Nest Education Consult. All rights reserved.</p>
            <div class="flex justify-center space-x-6">
                <a href="https://facebook.com" class="hover:text-green-300 transition duration-300"><i class="fab fa-facebook-f"></i></a>
                <a href="https://twitter.com" class="hover:text-green-300 transition duration-300"><i class="fab fa-twitter"></i></a>
                <a href="https://instagram.com" class="hover:text-green-300 transition duration-300"><i class="fab fa-instagram"></i></a>
                <a href="https://linkedin.com" class="hover:text-green-300 transition duration-300"><i class="fab fa-linkedin-in"></i></a>
            </div>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>
    <script>
        // Dark Mode Toggle
        $('#dark-mode-toggle').click(function() {
            $('body').toggleClass('dark-mode');
            const icon = $(this).find('i');
            if ($('body').hasClass('dark-mode')) {
                icon.removeClass('fa-moon').addClass('fa-sun');
            } else {
                icon.removeClass('fa-sun').addClass('fa-moon');
            }
        });

        // Admin Login
        $('#login-form').submit(function(e) {
            e.preventDefault();
            const username = $('#username').val();
            const password = $('#password').val();
            $.post('/api/login', { username, password }, function(data) {
                if (data.token) {
                    Cookies.set('token', data.token, { expires: 1 });
                    $('#login-section').hide();
                    $('#blog-form').removeClass('hidden').show();
                    $('#login-form')[0].reset();
                } else {
                    alert('Invalid credentials');
                }
            }).fail(function() {
                alert('Login failed. Please try again.');
            });
        });

        // Blog Post Submission
        $('#submit-post').click(function() {
            const token = Cookies.get('token');
            if (!token) {
                alert('Please login first.');
                return;
            }
            const title = $('#post-title').val();
            const content = $('#post-content').val();
            if (title && content) {
                $.ajax({
                    url: '/api/blog',
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${token}` },
                    data: { title, content },
                    success: function(data) {
                        alert('Blog post submitted successfully!');
                        $('#post-title').val('');
                        $('#post-content').val('');
                        // Optionally, redirect or update UI
                    },
                    error: function() {
                        alert('Unauthorized or server error.');
                    }
                });
            }
        });
    </script>
</body>
</html>